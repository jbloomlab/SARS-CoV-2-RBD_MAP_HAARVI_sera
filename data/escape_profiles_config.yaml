# Specify configuration of escape profile and related plots.
#
# Each entry should be a key with the name of the plot. It then can
# have the following nested keys:
#   conditions -> specify antibodies / sera and names to use when plotting
#   plot_auto_identified_sites -> provide name of one of the thresholds for
#                                 identifying sites of strong escape, or false
#                                 to not plot auto-identified strong sites.
#   add_sites -> list of any additional sites to plot
#   exclude_sites -> list of any sites to exclude from plot
#   site_color_scheme -> site-level color scheme in `site_color_schemes.csv`
#                        **or** color for all sites
#   mutation_colors -> dict keyed by mutation (e.g., P484) with value being color
#   color_by_dms -> make copies of escape profiles colored by DMS bind / expr
#   make_supp_data -> make supplemental data / dms-view file
#   single_nt_only -> only include single-nt mutations relative to Genbank file
#                     specified here in escape profiles.
#   draw_line_plot -> set to false to not show line plot in escape profile
#   analyze_natural_mutations -> analyze naturally occuring mutations at sites
#                                of strong escape.
#   natural_mutations_mincounts -> plot escape grid for all sites of strong
#                                  escape with >= this many mutation counts.
#   escape_profile_ymax -> override default for this parameter specified
#                          in main `config.yaml`.
#   shade_sites -> shade the stacks for certain sites. Key by the antibody name
#                  (using the short names defined as values in `conditions`),
#                  and then the values are maps of site to the list [color, alpha]


human_sera:  # name of plot
  conditions:  # antibodies / sera to show and names to use for them
    23_d21_1250: 23_d21
    23_d45_1250: 23_d45
    23_d120_500: 23_d120
    1C_d26_200: 1C_d26
    1C_d113_200: 1C_d113
    24C_d32_200: 24C_d32
    24C_d104_200: 24C_d104
    6C_d33_500: 6C_d33
    6C_d76_500: 6C_d76
    22C_d28_200: 22C_d28
    22C_d104_200: 22C_d104
    25C_d48_200: 25C_d48
    25C_d115_80: 25C_d115
    25_d18_500: 25_d18
    25_d94_200: 25_d94
    12C_d61_160: 12C_d61
    12C_d152_80: 12C_d152
    23C_d26_80: 23C_d26
    23C_d102_80: 23C_d102
    13_d15_200: 13_d15
    13_d121_1250: 13_d121
    7C_d29_500: 7C_d29
    7C_d103_200: 7C_d103
  # plot automatically identified sites?
  plot_auto_identified_sites: default
  # add these sites if they aren't automatically identified
  add_sites: []
  # exclude these sites even if not automatically identified
  exclude_sites: []
  # name of site-level color scheme in `site_color_schemes.csv` **or**
  # color for all sites
  site_color_scheme: subdomain
  # make escape profiles colored by DMS bind / expr measurements?
  color_by_dms: True
  # make supplemental data files for this antibody set
  make_supp_data: true
  # analyze naturally occurring mutations at strong sites of escape
  analyze_natural_mutations: true
  natural_mutations_mincounts: 5  # plot sites with >= this many mutation counts
  escape_profile_ymax:
    quantile: 0.5
    frac: 0.05
    min_ymax: 1
  dmslogo_facet_plot_kwargs:
    height_per_ax: 2.0
  dmslogo_draw_line_kwargs:
    widthscale: 0.64

human_sera_figS3:  # name of plot
  conditions:  # antibodies / sera to show and names to use for them
    23_d21_1250: 23_d21
    1C_d26_200: 1C_d26
    24C_d32_200: 24C_d32
    6C_d33_500: 6C_d33
    22C_d28_200: 22C_d28
    25C_d48_200: 25C_d48
    25_d18_500: 25_d18
    12C_d61_160: 12C_d61
    23C_d26_80: 23C_d26
    13_d15_200: 13_d15
    7C_d29_500: 7C_d29
    23_d45_1250: 23_d45
    23_d120_500: 23_d120
    1C_d113_200: 1C_d113
    24C_d104_200: 24C_d104
    6C_d76_500: 6C_d76
    22C_d104_200: 22C_d104
    25C_d115_80: 25C_d115
    25_d94_200: 25_d94
    12C_d152_80: 12C_d152
    23C_d102_80: 23C_d102
    13_d121_1250: 13_d121
    7C_d103_200: 7C_d103
  # plot automatically identified sites?
  plot_auto_identified_sites: default
  # add these sites if they aren't automatically identified
  add_sites: []
  # exclude these sites even if not automatically identified
  exclude_sites: [361]
  # name of site-level color scheme in `site_color_schemes.csv` **or**
  # color for all sites
  site_color_scheme: subdomain
  # make escape profiles colored by DMS bind / expr measurements?
  color_by_dms: True
  # make supplemental data files for this antibody set
  make_supp_data: true
  # analyze naturally occurring mutations at strong sites of escape
  analyze_natural_mutations: true
  natural_mutations_mincounts: 5  # plot sites with >= this many mutation counts
  escape_profile_ymax:
    quantile: 0.5
    frac: 0.05
    min_ymax: 1
  dmslogo_facet_plot_kwargs:
    height_per_ax: 2.0
  dmslogo_draw_line_kwargs:
    widthscale: 0.64

human_sera_fig4:  # name of plot
  conditions:  # antibodies / sera to show and names to use for them
    1C_d26_200: 1C_d26
    24C_d32_200: 24C_d32
    25_d18_500: 25_d18
    7C_d29_500: 7C_d29
    1C_d113_200: 1C_d113
    24C_d104_200: 24C_d104
    25_d94_200: 25_d94
    7C_d103_200: 7C_d103
  # plot automatically identified sites?
  plot_auto_identified_sites: default
  # add these sites if they aren't automatically identified
  add_sites: []
  # exclude these sites even if not automatically identified
  exclude_sites: [361]
  # name of site-level color scheme in `site_color_schemes.csv` **or**
  # color for all sites
  site_color_scheme: subdomain
  # make escape profiles colored by DMS bind / expr measurements?
  color_by_dms: True
  # make supplemental data files for this antibody set
  make_supp_data: false
  # analyze naturally occurring mutations at strong sites of escape
  analyze_natural_mutations: false
  natural_mutations_mincounts: 5  # plot sites with >= this many mutation counts
  escape_profile_ymax:
    quantile: 0.5
    frac: 0.05
    min_ymax: 1
  dmslogo_facet_plot_kwargs:
    height_per_ax: 2.0
  dmslogo_draw_line_kwargs:
    widthscale: 0.64

human_sera_fig4A_1C:  # name of plot
  conditions:  # antibodies / sera to show and names to use for them
    1C_d26_200: 1C d26
    1C_d113_200: 1C d113
  plot_auto_identified_sites: default
  # add the sites that are auto-identified for 1C, 24C, 25, and 7C
  add_sites: [365, 369, 396, 443, 444, 445, 446, 447, 448, 449, 450, 456, 473, 484, 499]
  exclude_sites: [361]
  site_color_scheme: subdomain
  escape_profile_ymax:
    quantile: 0.5
    frac: 0.05
    min_ymax: 1
  dmslogo_facet_plot_kwargs:
    height_per_ax: 2.0
  dmslogo_draw_line_kwargs:
    widthscale: 0.64

human_sera_fig4B_24C:  # name of plot
  conditions:
    24C_d32_200: 24C d32
    24C_d104_200: 24C d104
  plot_auto_identified_sites: default
  # add the sites that are auto-identified for 1C, 24C, 25, and 7C
  add_sites: [365, 369, 396, 443, 444, 445, 446, 447, 448, 449, 450, 456, 473, 484, 499]
  exclude_sites: [361]
  site_color_scheme: subdomain
  escape_profile_ymax:
    quantile: 0.5
    frac: 0.05
    min_ymax: 1
  dmslogo_facet_plot_kwargs:
    height_per_ax: 2.0
  dmslogo_draw_line_kwargs:
    widthscale: 0.64

human_sera_fig4C_25:  # name of plot
  conditions:
    25_d18_500: 25 d18
    25_d94_200: 25 d94
  plot_auto_identified_sites: default
  # add the sites that are auto-identified for 1C, 24C, 25, and 7C
  add_sites: [365, 369, 396, 443, 444, 445, 446, 447, 448, 449, 450, 456, 473, 484, 499]
  exclude_sites: [361]
  site_color_scheme: subdomain
  escape_profile_ymax:
    quantile: 0.5
    frac: 0.05
    min_ymax: 1
  dmslogo_facet_plot_kwargs:
    height_per_ax: 2.0
  dmslogo_draw_line_kwargs:
    widthscale: 0.64

human_sera_fig4D_7C:  # name of plot
  conditions:
    7C_d29_500: 7C d29
    7C_d103_200: 7C d103
  plot_auto_identified_sites: default
  # add the sites that are auto-identified for 1C, 24C, 25, and 7C
  add_sites: [365, 369, 396, 443, 444, 445, 446, 447, 448, 449, 450, 456, 473, 484, 499]
  exclude_sites: [361]
  site_color_scheme: subdomain
  escape_profile_ymax:
    quantile: 0.5
    frac: 0.05
    min_ymax: 1
  dmslogo_facet_plot_kwargs:
    height_per_ax: 2.0
  dmslogo_draw_line_kwargs:
    widthscale: 0.64

human_sera_fig4E_25C:  # name of plot
  conditions:  # antibodies / sera to show and names to use for them
    25C_d48_200: 25C_d48
    25C_d115_80: 25C_d115
  plot_auto_identified_sites: default
  # add the sites that are auto-identified for 1C, 24C, 25, and 7C
  add_sites: [365, 369, 396, 443, 444, 445, 446, 447, 448, 449, 450, 456, 473, 484, 499]
  exclude_sites: [361]
  site_color_scheme: subdomain
  escape_profile_ymax:
    quantile: 0.5
    frac: 0.05
    min_ymax: 1
  dmslogo_facet_plot_kwargs:
    height_per_ax: 2.0
  dmslogo_draw_line_kwargs:
    widthscale: 0.64

human_sera_early_fig2:  # name of plot
  conditions:  # antibodies / sera to show and names to use for them
    23_d21_1250: 23_d21
    1C_d26_200: 1C_d26
    24C_d32_200: 24C_d32
    6C_d33_500: 6C_d33
    22C_d28_200: 22C_d28
    25C_d48_200: 25C_d48
    25_d18_500: 25_d18
    12C_d61_160: 12C_d61
    23C_d26_80: 23C_d26
    13_d15_200: 13_d15
    7C_d29_500: 7C_d29
  plot_auto_identified_sites: default
  add_sites: []
  exclude_sites: [361]
  draw_line_plot: true
  site_color_scheme: subdomain
  color_by_dms: false
  make_supp_data: false
  analyze_natural_mutations: false
  natural_mutations_mincounts: 5
  escape_profile_ymax:
    quantile: 0.5
    frac: 0.05
    min_ymax: 1
  dmslogo_facet_plot_kwargs:
    height_per_ax: 2.0
  dmslogo_draw_line_kwargs:
    widthscale: 0.64

human_sera_early:  # name of plot
  conditions:  # antibodies / sera to show and names to use for them
    23_d21_1250: 23_d21
    1C_d26_200: 1C_d26
    24C_d32_200: 24C_d32
    6C_d33_500: 6C_d33
    22C_d28_200: 22C_d28
    25C_d48_200: 25C_d48
    25_d18_500: 25_d18
    12C_d61_160: 12C_d61
    23C_d26_80: 23C_d26
    13_d15_200: 13_d15
    7C_d29_500: 7C_d29
  plot_auto_identified_sites: default
  add_sites: []
  exclude_sites: []
  draw_line_plot: false
  site_color_scheme: subdomain
  color_by_dms: false
  make_supp_data: false
  analyze_natural_mutations: false
  natural_mutations_mincounts: 5
  escape_profile_ymax:
    quantile: 0.5
    frac: 0.05
    min_ymax: 1

13_validations:
  conditions:
    13_d15_200: 13 d15
    13_d121_1250: 13 d121
  plot_auto_identified_sites: false
  add_sites: [384,446,456,484,485,494]
  exclude_sites: []
  site_color_scheme: gray
  mutation_colors:
    L384: '#D55E00'
    P484: '#D55E00'
  escape_profile_ymax:
    quantile: 0.5
    frac: 0.05
    min_ymax: 1
  draw_line_plot: false

1C_validations:
  conditions:
    1C_d26_200: 1C d26
    1C_d113_200: 1C d113
  plot_auto_identified_sites: false
  add_sites: [384,446,456,484,485,494]
  exclude_sites: []
  site_color_scheme: gray
  mutation_colors:
    K456: '#D55E00'
    P484: '#D55E00'
    Q484: '#D55E00'
  escape_profile_ymax:
    quantile: 0.5
    frac: 0.05
    min_ymax: 1
  draw_line_plot: false

22C_validations:
  conditions:
    22C_d28_200: 22C d28
    22C_d104_200: 22C d104
  plot_auto_identified_sites: false
  add_sites: [384,446,456,484,485,494]
  exclude_sites: []
  site_color_scheme: gray
  mutation_colors:
    P494: '#D55E00'
    P484: '#D55E00'
  escape_profile_ymax:
    quantile: 0.5
    frac: 0.05
    min_ymax: 1
  draw_line_plot: false

23_validations:
  conditions:
    23_d21_1250: 23 d21
    23_d120_500: 23 d120
  plot_auto_identified_sites: false
  add_sites: [384,446,456,484,485,494]
  exclude_sites: []
  site_color_scheme: gray
  mutation_colors:
    L384: '#D55E00'
    P484: '#D55E00'
  escape_profile_ymax:
    quantile: 0.5
    frac: 0.05
    min_ymax: 1
  draw_line_plot: false

23C_validations:
  conditions:
    23C_d26_80: 23C d26
    23C_d102_80: 23C d102
  plot_auto_identified_sites: false
  add_sites: [384,446,456,484,485,494]
  exclude_sites: []
  site_color_scheme: gray
  mutation_colors:
    V446: '#D55E00'
    R485: '#D55E00'
    Q484: '#D55E00'
    P494: '#D55E00'
  escape_profile_ymax:
    quantile: 0.5
    frac: 0.05
    min_ymax: 1
  draw_line_plot: false

24C_validations:
  conditions:
    24C_d32_200: 24C d32
    24C_d104_200: 24C d104
  plot_auto_identified_sites: false
  add_sites: [384,446,456,484,485,494]
  exclude_sites: []
  site_color_scheme: gray
  mutation_colors:
    A456: '#D55E00'
    K456: '#D55E00'
    P484: '#D55E00'
    Q484: '#D55E00'
  escape_profile_ymax:
    quantile: 0.5
    frac: 0.05
    min_ymax: 1
  draw_line_plot: false

25_validations:
  conditions:
    25_d18_500: 25 d18
    25_d94_200: 25 d94
  plot_auto_identified_sites: false
  add_sites: [384,446,456,484,485,494]
  exclude_sites: []
  site_color_scheme: gray
  mutation_colors:
    V456: '#D55E00'
    P484: '#D55E00'
    V446: '#D55E00'
  escape_profile_ymax:
    quantile: 0.5
    frac: 0.05
    min_ymax: 1
  draw_line_plot: false

7C_validations:
  conditions:
    7C_d29_500: 7C d29
    7C_d103_200: 7C d103
  plot_auto_identified_sites: false
  add_sites: [384,446,456,484,485,494]
  exclude_sites: []
  site_color_scheme: gray
  mutation_colors:
    A456: '#D55E00'
    V456: '#D55E00'
    P484: '#D55E00'
  escape_profile_ymax:
    quantile: 0.5
    frac: 0.05
    min_ymax: 1
  draw_line_plot: false

2165_validation:
  conditions:
    COV2-2165_400: COV2-2165
  plot_auto_identified_sites: false
  add_sites: [420,456]
  exclude_sites: []
  site_color_scheme: gray
  mutation_colors:
    A456: '#D55E00'
    K456: '#D55E00'
  escape_profile_ymax:
    quantile: 0.5
    frac: 0.05
    min_ymax: 1
  draw_line_plot: false

CB6_validation:
  conditions:
    CB6_400: CB6
  plot_auto_identified_sites: false
  add_sites: [417,456]
  exclude_sites: []
  site_color_scheme: gray
  mutation_colors:
    A456: '#D55E00'
    K456: '#D55E00'
  escape_profile_ymax:
    quantile: 0.5
    frac: 0.05
    min_ymax: 1
  draw_line_plot: false

2082_validation:
  conditions:
    COV2-2082_400: COV2-2082
  plot_auto_identified_sites: false
  add_sites: [378,456]
  exclude_sites: []
  site_color_scheme: gray
  mutation_colors:
    A456: '#D55E00'
    K456: '#D55E00'
  escape_profile_ymax:
    quantile: 0.5
    frac: 0.05
    min_ymax: 1
  draw_line_plot: false

2832_validation:
  conditions:
    COV2-2832_400: COV2-2832
  plot_auto_identified_sites: false
  add_sites: [486,456]
  exclude_sites: []
  site_color_scheme: gray
  mutation_colors:
    A456: '#D55E00'
    K456: '#D55E00'
  escape_profile_ymax:
    quantile: 0.5
    frac: 0.05
    min_ymax: 1
  draw_line_plot: false
