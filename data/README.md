# Input data

This directory contains input data used for the analysis and configuration for some of the analyses:

 - [barcode_runs.csv](barcode_runs.csv): Illumina sequencing runs for barcode counting.
   The *sample* column should be the hyphen separated concatenation of *experiment*, *antibody*, *concentration*, and *selection*.
   The **combination** of the *library* and *sample* columns should be unique.
   The *frac_escape* column gives the overall fraction of the library that escaped antibody.
   The *R1* FASTQ files should be semicolon (`; `) separated list of glob patterns.

 - [wildtype_sequence.fasta](wildtype_sequence.fasta): wildtype sequence of mutagenized gene.

 - [./pdbs/](pdbs): files downloaded from the [Protein Data Bank](https://www.rcsb.org/) for structural analyses. The 7c01.pdb structure was modified to give the 7c01_single.pdb: the original structure has two Fab:RBD complexes within the asymmetric unit, so we removed chains B, C, and D to leave just one complex for visualization.

 - [escape_profiles_config.yaml](escape_profiles_config.yaml): Information on how to plot the escape profiles; manually edit this to alter their plotting.

 - [mds_config.yaml](mds_config.yaml): Information on how to do the multi-dimensional scaling.

 - [output_pdbs_config.yaml](output_pdbs_config.yaml): Information on how to output structural mappings of escape.
 
 - [structural_annotation_config.yaml](structural_annotation_config.yaml): Information on how to output structural annotations of contact residues in various RBD:ligand complexes.

 - [site_color_schemes.csv](site_color_schemes.csv): Schemes for how to color sites (can be used in escape profiles). Here are details on these schemes.

   - The `subdomain` scheme colors sites orange if they directly contact ACE2 (within 4 angstroms in PDB 6m0j) in the SARS-CoV-2 structure (residues 417, 446, 449, 453, 455, 456, 475, 486, 487, 489, 493, 496, 498, 500, 501, 502, 505), blue if they are in the receptor binding motif (RBM, residue 437 to 508, inclusive), and green if they are in the core RBD domain (all other sites). These definitions match those used in [Starr et al (2020)](https://www.cell.com/cell/fulltext/S0092-8674(20)31003-5).

 -  [spikeprot1112.fasta.xz](spikeprot1112.fasta.xz): A compressed FASTA file with all spike sequences in GISAID. Downloaded on Nov-12-2020 as follows: logged into GISAID, went to the *EpiCoV* page, clicked on *Downloads*, clicked on *spikeprot1112*, which yielded the file `spikeprot1112.fasta.xz` which was then copied here.

 - [./RBD_sites.csv](RBD_sites.csv): Useful numeric and functional annotations of RBD sites for referencing in various analyses.

 - [./RBDs_aligned.fasta](RBDs_aligned.fasta): alignment of sarbecovirus RBDs

 - [escape_selection_results.yaml](escape_selection_results.yaml): results of viral escape-mutant selections, used to make plots about these.

 - [Whelan-VSV-SARS-CoV-2-Spike.gb](Whelan-VSV-SARS-CoV-2-Spike.gb) is the sequence of the Spike in the VSV virus expressing the SARS-CoV-2 Spike used by the Crowe lab (originally from Whelan lab); sequence provided by Seth Zost.

 - [./Baum_Spike.gb](Baum_Spike.gb) is the SARS-CoV-2 Wuhan-Hu-1 Spike gene sequence from MN908947.3. [Baum et al. (2020)](https://science.sciencemag.org/content/369/6506/1014) uses this sequence in their study, according to their methods: "Fully replicative VSV-SARS-CoV-2-S virus was generated by replacing the VSV glycoprotein with the native SARS-CoV-2 sequences encoding residues 1-1255 of the spike protein (MN908947.3)." It is unclear whether there may have been tissue culture adaptations in the actual viral stock used in the in vitro selection experiments, as the methods don't report this.

 - [./Weisblum_SinoBiological_Spike.gb](Weisblum_SinoBiological_Spike.gb) is Allie's best guess at the Spike sequence used in the [Weisblum et al. bioRxiv (2020)](https://www.biorxiv.org/content/10.1101/2020.07.21.214759v1.full) in vitro VSV-Spike selection experiments. This is based off this text from the methods:

   * "The generation of infectious rVSV/SARS-CoV-2/GFP chimeric viruses
     stocks has been previously described (24). Two plaque purified
     variants designated rVSV/SARS-CoV-2/GFP1D7 and rVSV/SARS-CoV-2/
     GFP2E1 that encode F157S/R685M (1D7) and D215G/R683G (2E1)
     substitutions were used in these studies."

   * "For selection of viruses resistant to plasma or monoclonal
     antibodies, rVSV/SARS-CoV-2/GFP1D7 and rVSV/SARS-CoV-2/GFP2E1 
     populations containing 106 infectious particles were incubated with
     dilutions of monoclonal antibodies (10μg/ml, 5μg/ml) or COVID19
     plasma (1:50, 1:250, 1:500) for 1h at 37°C. "

   * Reference 24 is [Schmidt, et al. (2020)](https://rupress.org/jem/article/217/11/e20201181/151961/Measuring-SARS-CoV-2-neutralizing-antibody), which states:
     "To construct a replication competent rVSV/SARS-CoV-2 chimeric virus clone, a codonoptimized cDNA sequence encoding the SARS-CoV-2 spike protein (SinoBiological) but lacking the C-terminal 18 codons was inserted, using Gibson cloning, into a recombinant VSV background that contains GFP immediately upstream of the L (polymerase) following a strategy we previously described for the exchange of VSV-G with HIV-1 Env proteins (Liberatore et al., 2019)"

   * None of the 2E1 or 1D7 mutations described are to the sequence of the RBD, so I (Allie Greaney) have copied here the SinoBiological sequence from [here](https://www.sinobiological.com/cdna-clone/2019-ncov-cov-spike-vg40589-ut), called "SARS-CoV-2 (2019-nCoV) Spike ORF mammalian expression plasmid (Codon Optimized)"

- [./pse_config_6m0j.yaml](pse_config_6m0j.yaml): a configuration file to write PyMol commands using the results of `output_pdbs.ipynb` to create a PSE session for certain selections. 